<!DOCTYPE html>
<html>
 <head>
  <base target="_self">
  <?!= include('styles') ?>
  <?!= include('scripts') ?>
 </head>
 <body>
 <?!= include('menu') ?>
 
 <div class="container">
   <div class="columns">
     <div class="column col-12 text-center">
       <h4>General Settings</h4>
     </div>
     <form class="column col-8 col-md-10 col-sm-12 col-mx-auto form-horizontal" onsubmit="handleFormSubmit(this)">
       <?!= input_field('site_name', 'Site Name', 'text') ?>
       <?!= input_field('checkin_time', 'Check-In Time', 'time') ?>
       <?!= input_field('checkout_time', 'Check-Out Time', 'time') ?>
       <?!= input_field('guest_text', 'Guest Text', 'textarea', 
           {maxlength: 160, hint: 'This is the first text sent to the guest, when the calendar notifies us of upcoming stay'}) ?>

       <? var aliases = GmailApp.getAliases() ?>
       <? aliases.unshift(Session.getActiveUser().getEmail()) ?>
       <div class="form-group">
         <div class="col-3 col-sm-12">
           <label class="form-label" for="mail_from">Mail From</label>
         </div>
         <div class="col-9 col-sm-12">
           <select class="form-select" id="mail_from" name="mail_from">
             <? for (var i = 0; i < aliases.length; i++) { ?>
               <option value="<?= aliases[i] ?>" <?= properties.getProperty('mail_from') == aliases[i] ? "selected" : "" ?>><?= aliases[i] ?></option>
             <? } ?>
           </select>
           <span class="form-input-hint">Add <a href="https://mail.google.com/mail/u/0/#settings/accounts" rel="noopener noreferrer" target="_blank">aliases in GMail</a> for other options</span>
         </div>
       </div>
       
       <?!= input_field('email_signature', 'Email Signature', 'textarea') ?>
       <?!= input_field('master_switch', 'Production', 'switch') ?>
       <?!= include('submit_form') ?>
    </form>
    </div>
    </div>
  </body>
</html>
